<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>
            Mayflower Code Browser - Source Code
        </title>
        <link rel="stylesheet" type="text/css" href="../../../js/jquery.sidebar/css/codebrowser/sidebar.css" />
        <link rel="stylesheet" type="text/css" href="../../../css/global.css" />
        <link rel="stylesheet" type="text/css" href="../../../css/cruisecontrol.css" />
        <link rel="stylesheet" type="text/css" href="../../../css/review.css" />

        <script type="text/javascript" src="../../../js/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="../../../js/jquery.sidebar/jquery-ui-1.7.2.custom.min.js"></script>
        <script type="text/javascript" src="../../../js/jquery.sidebar/jquery.sidebar.js"></script>
        <script type="text/javascript" src="../../../js/jquery.cluetip/lib/jquery.hoverIntent.js"></script>
        <script type="text/javascript" src="../../../js/jquery.cluetip/lib/jquery.bgiframe.min.js"></script>
        <script type="text/javascript" src="../../../js/jquery.cluetip/jquery.cluetip.min.js"></script>

        <script type="text/javascript" src="../../../js/review.js"></script>
    </head>
    <body class="codebrowser">
        <div class="header">
            <a href="./../../../index.html">Go back to index</a> |
            <a href="http://github.com/mayflowergmbh/PHP_CodeBrowser">PHP CodeBrowser</a>
        </div>
        <hr/>
        <div id="review">
            <div class="filepath">
                js/tiny_mce/plugins/media/editor_plugin.js            </div>

            <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="code"><ol class="code"><li id="line_1" class="odd"><span class="lineNumber">1&nbsp;</span>&nbsp;<span class="brackets">(</span><span class="keyword">function</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">d</span><span class="code">=</span><span class="default">tinymce</span><span class="code">.</span><span class="default">explode</span><span class="brackets">(</span><span class="string">"</span><span class="string">id,name,width,height,style,align,class,hspace,vspace,bgcolor,type</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">h</span><span class="code">=</span><span class="default">tinymce</span><span class="code">.</span><span class="default">makeMap</span><span class="brackets">(</span><span class="default">d</span><span class="code">.</span><span class="default">join</span><span class="brackets">(</span><span class="string">"</span><span class="string">,</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">,</span><span class="default">b</span><span class="code">=</span><span class="default">tinymce</span><span class="code">.</span><span class="default">html</span><span class="code">.</span><span class="default">Node</span><span class="code">,</span><span class="default">f</span><span class="code">,</span><span class="default">a</span><span class="code">,</span><span class="default">g</span><span class="code">=</span><span class="default">tinymce</span><span class="code">.</span><span class="default">util</span><span class="code">.</span><span class="default">JSON</span><span class="code">,</span><span class="default">e</span><span class="code">;</span><span class="default">f</span><span class="code">=</span><span class="brackets">[</span><span class="brackets">[</span><span class="string">"</span><span class="string">Flash</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">d27cdb6e-ae6d-11cf-96b8-444553540000</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">application/x-shockwave-flash</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0</span><span class="string">"</span><span class="brackets">]</span><span class="code">,</span><span class="brackets">[</span><span class="string">"</span><span class="string">ShockWave</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">166b1bca-3f9c-11cf-8075-444553540000</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">application/x-director</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0</span><span class="string">"</span><span class="brackets">]</span><span class="code">,</span><span class="brackets">[</span><span class="string">"</span><span class="string">WindowsMedia</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">6bf52a52-394a-11d3-b153-00c04f79faa6,22d6f312-b0f6-11d0-94ab-0080c74c7e95,05589fa1-c356-11ce-bf01-00aa0055595a</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">application/x-mplayer2</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701</span><span class="string">"</span><span class="brackets">]</span><span class="code">,</span><span class="brackets">[</span><span class="string">"</span><span class="string">QuickTime</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">02bf25d5-8c17-4b23-bc80-d3488abddc6b</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">video/quicktime</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0</span><span class="string">"</span><span class="brackets">]</span><span class="code">,</span><span class="brackets">[</span><span class="string">"</span><span class="string">RealMedia</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">cfcdaa03-8be4-11cf-b84b-0020afbbccfa</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">audio/x-pn-realaudio-plugin</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0</span><span class="string">"</span><span class="brackets">]</span><span class="code">,</span><span class="brackets">[</span><span class="string">"</span><span class="string">Java</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">8ad9c840-044e-11d1-b3e9-00805f499d93</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">application/x-java-applet</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">http://java.sun.com/products/plugin/autodl/jinstall-1_5_0-windows-i586.cab#Version=1,5,0,0</span><span class="string">"</span><span class="brackets">]</span><span class="code">,</span><span class="brackets">[</span><span class="string">"</span><span class="string">Silverlight</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">dfeaf541-f3e1-4c24-acac-99c30715084a</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">application/x-silverlight-2</span><span class="string">"</span><span class="brackets">]</span><span class="code">,</span><span class="brackets">[</span><span class="string">"</span><span class="string">Iframe</span><span class="string">"</span><span class="brackets">]</span><span class="code">,</span><span class="brackets">[</span><span class="string">"</span><span class="string">Video</span><span class="string">"</span><span class="brackets">]</span><span class="brackets">]</span><span class="code">;</span><span class="keyword">function</span><span class="code"> </span><span class="default">c</span><span class="brackets">(</span><span class="default">m</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">l</span><span class="code">,</span><span class="default">j</span><span class="code">,</span><span class="default">k</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">m</span><span class="code">&amp;&amp;!</span><span class="default">m</span><span class="code">.</span><span class="default">splice</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">j</span><span class="code">=</span><span class="brackets">[</span><span class="brackets">]</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">k</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="keyword">true</span><span class="code">;</span><span class="default">k</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">m</span><span class="brackets">[</span><span class="default">k</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">j</span><span class="brackets">[</span><span class="default">k</span><span class="brackets">]</span><span class="code">=</span><span class="default">m</span><span class="brackets">[</span><span class="default">k</span><span class="brackets">]</span><span class="brackets">}</span><span class="keyword">else</span><span class="brackets">{</span><span class="keyword">break</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">return</span><span class="code"> </span><span class="default">j</span><span class="brackets">}</span><span class="keyword">return</span><span class="code"> </span><span class="default">m</span><span class="brackets">}</span><span class="default">tinymce</span><span class="code">.</span><span class="default">create</span><span class="brackets">(</span><span class="string">"</span><span class="string">tinymce.plugins.MediaPlugin</span><span class="string">"</span><span class="code">,</span><span class="brackets">{</span><span class="default">init</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">n</span><span class="code">,</span><span class="default">j</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">r</span><span class="code">=</span><span class="keyword">this</span><span class="code">,</span><span class="default">l</span><span class="code">=</span><span class="brackets">{</span><span class="brackets">}</span><span class="code">,</span><span class="default">m</span><span class="code">,</span><span class="default">p</span><span class="code">,</span><span class="default">q</span><span class="code">,</span><span class="default">k</span><span class="code">;</span><span class="keyword">function</span><span class="code"> </span><span class="default">o</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="code"> </span><span class="default">i</span><span class="code">&amp;&amp;</span><span class="default">i</span><span class="code">.</span><span class="default">nodeName</span><span class="code">===</span><span class="string">"</span><span class="string">IMG</span><span class="string">"</span><span class="code">&amp;&amp;</span><span class="default">n</span><span class="code">.</span><span class="default">dom</span><span class="code">.</span><span class="default">hasClass</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="string">"</span><span class="string">mceItemMedia</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="default">r</span><span class="code">.</span><span class="default">editor</span><span class="code">=</span><span class="default">n</span><span class="code">;</span><span class="default">r</span><span class="code">.</span><span class="default">url</span><span class="code">=</span><span class="default">j</span><span class="code">;</span><span class="default">a</span><span class="code">=</span><span class="string">"</span><span class="string">"</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">m</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">m</span><span class="code">&lt;</span><span class="default">f</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">m</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">k</span><span class="code">=</span><span class="default">f</span><span class="brackets">[</span><span class="default">m</span><span class="brackets">]</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="code">;</span><span class="default">q</span><span class="code">=</span><span class="brackets">{</span><span class="default">name</span><span class="code">:</span><span class="default">k</span><span class="code">,</span><span class="default">clsids</span><span class="code">:</span><span class="default">tinymce</span><span class="code">.</span><span class="default">explode</span><span class="brackets">(</span><span class="default">f</span><span class="brackets">[</span><span class="default">m</span><span class="brackets">]</span><span class="brackets">[</span><span class="number">1</span><span class="brackets">]</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">mimes</span><span class="code">:</span><span class="default">tinymce</span><span class="code">.</span><span class="default">explode</span><span class="brackets">(</span><span class="default">f</span><span class="brackets">[</span><span class="default">m</span><span class="brackets">]</span><span class="brackets">[</span><span class="number">2</span><span class="brackets">]</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">codebase</span><span class="code">:</span><span class="default">f</span><span class="brackets">[</span><span class="default">m</span><span class="brackets">]</span><span class="brackets">[</span><span class="number">3</span><span class="brackets">]</span><span class="brackets">}</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">p</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">p</span><span class="code">&lt;</span><span class="default">q</span><span class="code">.</span><span class="default">clsids</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">p</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">l</span><span class="brackets">[</span><span class="string">"</span><span class="string">clsid:</span><span class="string">"</span><span class="code">+</span><span class="default">q</span><span class="code">.</span><span class="default">clsids</span><span class="brackets">[</span><span class="default">p</span><span class="brackets">]</span><span class="brackets">]</span><span class="code">=</span><span class="default">q</span><span class="brackets">}</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">p</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">p</span><span class="code">&lt;</span><span class="default">q</span><span class="code">.</span><span class="default">mimes</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">p</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">l</span><span class="brackets">[</span><span class="default">q</span><span class="code">.</span><span class="default">mimes</span><span class="brackets">[</span><span class="default">p</span><span class="brackets">]</span><span class="brackets">]</span><span class="code">=</span><span class="default">q</span><span class="brackets">}</span><span class="default">l</span><span class="brackets">[</span><span class="string">"</span><span class="string">mceItem</span><span class="string">"</span><span class="code">+</span><span class="default">k</span><span class="brackets">]</span><span class="code">=</span><span class="default">q</span><span class="code">;</span><span class="default">l</span><span class="brackets">[</span><span class="default">k</span><span class="code">.</span><span class="default">toLowerCase</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">]</span><span class="code">=</span><span class="default">q</span><span class="code">;</span><span class="default">a</span><span class="code">+=</span><span class="brackets">(</span><span class="default">a</span><span class="code">?</span><span class="string">"</span><span class="string">|</span><span class="string">"</span><span class="code">:</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">+</span><span class="default">k</span><span class="brackets">}</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">n</span><span class="code">.</span><span class="default">getParam</span><span class="brackets">(</span><span class="string">"</span><span class="string">media_types</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">video=mp4,m4v,ogv,webm;silverlight=xap;flash=swf,flv;shockwave=dcr;quicktime=mov,qt,mpg,mp3,mpeg;shockwave=dcr;windowsmedia=avi,wmv,wm,asf,asx,wmx,wvx;realmedia=rm,ra,ram;java=jar</span><span class="string">"</span><span class="brackets">)</span><span class="code">.</span><span class="default">split</span><span class="brackets">(</span><span class="string">"</span><span class="string">;</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">v</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">s</span><span class="code">,</span><span class="default">u</span><span class="code">,</span><span class="default">t</span><span class="code">;</span><span class="default">v</span><span class="code">=</span><span class="default">v</span><span class="code">.</span><span class="default">split</span><span class="brackets">(</span><span class="code">/=/</span><span class="brackets">)</span><span class="code">;</span><span class="default">u</span><span class="code">=</span><span class="default">tinymce</span><span class="code">.</span><span class="default">explode</span><span class="brackets">(</span><span class="default">v</span><span class="brackets">[</span><span class="number">1</span><span class="brackets">]</span><span class="code">.</span><span class="default">toLowerCase</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">s</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">s</span><span class="code">&lt;</span><span class="default">u</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">s</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">t</span><span class="code">=</span><span class="default">l</span><span class="brackets">[</span><span class="default">v</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="code">.</span><span class="default">toLowerCase</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">]</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">t</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">l</span><span class="brackets">[</span><span class="default">u</span><span class="brackets">[</span><span class="default">s</span><span class="brackets">]</span><span class="brackets">]</span><span class="code">=</span><span class="default">t</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">a</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="keyword">RegExp</span><span class="brackets">(</span><span class="string">"</span><span class="string">write(</span><span class="string">"</span><span class="code">+</span><span class="default">a</span><span class="code">+</span><span class="string">"</span><span class="string">)</span><span class="special">\\</span><span class="string">(([^)]+)</span><span class="special">\\</span><span class="string">)</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">r</span><span class="code">.</span><span class="default">lookup</span><span class="code">=</span><span class="default">l</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">onPreInit</span><span class="code">.</span><span class="default">add</span><span class="brackets">(</span><span class="keyword">function</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">n</span><span class="code">.</span><span class="default">schema</span><span class="code">.</span><span class="default">addValidElements</span><span class="brackets">(</span><span class="string">"</span><span class="string">object[id|style|width|height|classid|codebase|*],param[name|value],embed[id|style|width|height|type|src|*],video[*],audio[*],source[*]</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">parser</span><span class="code">.</span><span class="default">addNodeFilter</span><span class="brackets">(</span><span class="string">"</span><span class="string">object,embed,video,audio,script,iframe</span><span class="string">"</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">s</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">t</span><span class="code">=</span><span class="default">s</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="keyword">while</span><span class="brackets">(</span><span class="default">t</span><span class="code">--</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">r</span><span class="code">.</span><span class="default">objectToImg</span><span class="brackets">(</span><span class="default">s</span><span class="brackets">[</span><span class="default">t</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">serializer</span><span class="code">.</span><span class="default">addNodeFilter</span><span class="brackets">(</span><span class="string">"</span><span class="string">img</span><span class="string">"</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">s</span><span class="code">,</span><span class="default">u</span><span class="code">,</span><span class="default">t</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">v</span><span class="code">=</span><span class="default">s</span><span class="code">.</span><span class="default">length</span><span class="code">,</span><span class="default">w</span><span class="code">;</span><span class="keyword">while</span><span class="brackets">(</span><span class="default">v</span><span class="code">--</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">w</span><span class="code">=</span><span class="default">s</span><span class="brackets">[</span><span class="default">v</span><span class="brackets">]</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="brackets">(</span><span class="default">w</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">class</span><span class="string">"</span><span class="brackets">)</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">.</span><span class="default">indexOf</span><span class="brackets">(</span><span class="string">"</span><span class="string">mceItemMedia</span><span class="string">"</span><span class="brackets">)</span><span class="code">!==-</span><span class="number">1</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">r</span><span class="code">.</span><span class="default">imgToObject</span><span class="brackets">(</span><span class="default">w</span><span class="code">,</span><span class="default">t</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">onInit</span><span class="code">.</span><span class="default">add</span><span class="brackets">(</span><span class="keyword">function</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">n</span><span class="code">.</span><span class="default">theme</span><span class="code">&amp;&amp;</span><span class="default">n</span><span class="code">.</span><span class="default">theme</span><span class="code">.</span><span class="default">onResolveName</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">n</span><span class="code">.</span><span class="default">theme</span><span class="code">.</span><span class="default">onResolveName</span><span class="code">.</span><span class="default">add</span><span class="brackets">(</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">s</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">s</span><span class="code">.</span><span class="default">name</span><span class="code">===</span><span class="string">"</span><span class="string">img</span><span class="string">"</span><span class="code">&amp;&amp;</span><span class="default">n</span><span class="code">.</span><span class="default">dom</span><span class="code">.</span><span class="default">hasClass</span><span class="brackets">(</span><span class="default">s</span><span class="code">.</span><span class="default">node</span><span class="code">,</span><span class="string">"</span><span class="string">mceItemMedia</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">s</span><span class="code">.</span><span class="default">name</span><span class="code">=</span><span class="string">"</span><span class="string">media</span><span class="string">"</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">n</span><span class="code">&amp;&amp;</span><span class="default">n</span><span class="code">.</span><span class="default">plugins</span><span class="code">.</span><span class="default">contextmenu</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">n</span><span class="code">.</span><span class="default">plugins</span><span class="code">.</span><span class="default">contextmenu</span><span class="code">.</span><span class="default">onContextMenu</span><span class="code">.</span><span class="default">add</span><span class="brackets">(</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">s</span><span class="code">,</span><span class="default">t</span><span class="code">,</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">i</span><span class="code">.</span><span class="default">nodeName</span><span class="code">===</span><span class="string">"</span><span class="string">IMG</span><span class="string">"</span><span class="code">&amp;&amp;</span><span class="default">i</span><span class="code">.</span><span class="default">className</span><span class="code">.</span><span class="default">indexOf</span><span class="brackets">(</span><span class="string">"</span><span class="string">mceItemMedia</span><span class="string">"</span><span class="brackets">)</span><span class="code">!==-</span><span class="number">1</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">t</span><span class="code">.</span><span class="default">add</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">title</span><span class="code">:</span><span class="string">"</span><span class="string">media.edit</span><span class="string">"</span><span class="code">,</span><span class="default">icon</span><span class="code">:</span><span class="string">"</span><span class="string">media</span><span class="string">"</span><span class="code">,</span><span class="default">cmd</span><span class="code">:</span><span class="string">"</span><span class="string">mceMedia</span><span class="string">"</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">addCommand</span><span class="brackets">(</span><span class="string">"</span><span class="string">mceMedia</span><span class="string">"</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">s</span><span class="code">,</span><span class="default">i</span><span class="code">;</span><span class="default">i</span><span class="code">=</span><span class="default">n</span><span class="code">.</span><span class="default">selection</span><span class="code">.</span><span class="default">getNode</span><span class="brackets">(</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">o</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">s</span><span class="code">=</span><span class="default">g</span><span class="code">.</span><span class="default">parse</span><span class="brackets">(</span><span class="default">n</span><span class="code">.</span><span class="default">dom</span><span class="code">.</span><span class="default">getAttrib</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="string">"</span><span class="string">data-mce-json</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">d</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">t</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">u</span><span class="code">=</span><span class="default">n</span><span class="code">.</span><span class="default">dom</span><span class="code">.</span><span class="default">getAttrib</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">t</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">u</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">s</span><span class="brackets">[</span><span class="default">t</span><span class="brackets">]</span><span class="code">=</span><span class="default">u</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">s</span><span class="code">.</span><span class="default">type</span><span class="code">=</span><span class="default">r</span><span class="code">.</span><span class="default">getType</span><span class="brackets">(</span><span class="default">i</span><span class="code">.</span><span class="default">className</span><span class="brackets">)</span><span class="code">.</span><span class="default">name</span><span class="code">.</span><span class="default">toLowerCase</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">s</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">s</span><span class="code">=</span><span class="brackets">{</span><span class="default">type</span><span class="code">:</span><span class="string">"</span><span class="string">flash</span><span class="string">"</span><span class="code">,</span><span class="default">video</span><span class="code">:</span><span class="brackets">{</span><span class="default">sources</span><span class="code">:</span><span class="brackets">[</span><span class="brackets">]</span><span class="brackets">}</span><span class="code">,</span><span class="default">params</span><span class="code">:</span><span class="brackets">{</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">}</span><span class="default">n</span><span class="code">.</span><span class="default">windowManager</span><span class="code">.</span><span class="default">open</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">file</span><span class="code">:</span><span class="default">j</span><span class="code">+</span><span class="string">"</span><span class="string">/media.htm</span><span class="string">"</span><span class="code">,</span><span class="default">width</span><span class="code">:</span><span class="number">430</span><span class="code">+</span><span class="default">parseInt</span><span class="brackets">(</span><span class="default">n</span><span class="code">.</span><span class="default">getLang</span><span class="brackets">(</span><span class="string">"</span><span class="string">media.delta_width</span><span class="string">"</span><span class="code">,</span><span class="number">0</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">,</span><span class="default">height</span><span class="code">:</span><span class="number">500</span><span class="code">+</span><span class="default">parseInt</span><span class="brackets">(</span><span class="default">n</span><span class="code">.</span><span class="default">getLang</span><span class="brackets">(</span><span class="string">"</span><span class="string">media.delta_height</span><span class="string">"</span><span class="code">,</span><span class="number">0</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">,</span><span class="default">inline</span><span class="code">:</span><span class="number">1</span><span class="brackets">}</span><span class="code">,</span><span class="brackets">{</span><span class="default">plugin_url</span><span class="code">:</span><span class="default">j</span><span class="code">,</span><span class="default">data</span><span class="code">:</span><span class="default">s</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">addButton</span><span class="brackets">(</span><span class="string">"</span><span class="string">media</span><span class="string">"</span><span class="code">,</span><span class="brackets">{</span><span class="default">title</span><span class="code">:</span><span class="string">"</span><span class="string">media.desc</span><span class="string">"</span><span class="code">,</span><span class="default">cmd</span><span class="code">:</span><span class="string">"</span><span class="string">mceMedia</span><span class="string">"</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">onNodeChange</span><span class="code">.</span><span class="default">add</span><span class="brackets">(</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">s</span><span class="code">,</span><span class="default">i</span><span class="code">,</span><span class="default">t</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">i</span><span class="code">.</span><span class="default">setActive</span><span class="brackets">(</span><span class="string">"</span><span class="string">media</span><span class="string">"</span><span class="code">,</span><span class="default">o</span><span class="brackets">(</span><span class="default">t</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="code">,</span><span class="default">convertUrl</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">k</span><span class="code">,</span><span class="default">n</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">j</span><span class="code">=</span><span class="keyword">this</span><span class="code">,</span><span class="default">m</span><span class="code">=</span><span class="default">j</span><span class="code">.</span><span class="default">editor</span><span class="code">,</span><span class="default">l</span><span class="code">=</span><span class="default">m</span><span class="code">.</span><span class="default">settings</span><span class="code">,</span><span class="default">o</span><span class="code">=</span><span class="default">l</span><span class="code">.</span><span class="default">url_converter</span><span class="code">,</span><span class="default">i</span><span class="code">=</span><span class="default">l</span><span class="code">.</span><span class="default">url_converter_scope</span><span class="code">||</span><span class="default">j</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">k</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="code"> </span><span class="default">k</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">n</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="code"> </span><span class="default">m</span><span class="code">.</span><span class="default">documentBaseURI</span><span class="code">.</span><span class="default">toAbsolute</span><span class="brackets">(</span><span class="default">k</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">return</span><span class="code"> </span><span class="default">o</span><span class="code">.</span><span class="default">call</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">k</span><span class="code">,</span><span class="string">"</span><span class="string">src</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">object</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="code">,</span><span class="default">getInfo</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="brackets">{</span><span class="default">longname</span><span class="code">:</span><span class="string">"</span><span class="string">Media</span><span class="string">"</span><span class="code">,</span><span class="default">author</span><span class="code">:</span><span class="string">"</span><span class="string">Moxiecode Systems AB</span><span class="string">"</span><span class="code">,</span><span class="default">authorurl</span><span class="code">:</span><span class="string">"</span><span class="string">http://tinymce.moxiecode.com</span><span class="string">"</span><span class="code">,</span><span class="default">infourl</span><span class="code">:</span><span class="string">"</span><span class="string">http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/media</span><span class="string">"</span><span class="code">,</span><span class="default">version</span><span class="code">:</span><span class="default">tinymce</span><span class="code">.</span><span class="default">majorVersion</span><span class="code">+</span><span class="string">"</span><span class="string">.</span><span class="string">"</span><span class="code">+</span><span class="default">tinymce</span><span class="code">.</span><span class="default">minorVersion</span><span class="brackets">}</span><span class="brackets">}</span><span class="code">,</span><span class="default">dataToImg</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">m</span><span class="code">,</span><span class="default">k</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">r</span><span class="code">=</span><span class="keyword">this</span><span class="code">,</span><span class="default">o</span><span class="code">=</span><span class="default">r</span><span class="code">.</span><span class="default">editor</span><span class="code">,</span><span class="default">p</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">documentBaseURI</span><span class="code">,</span><span class="default">j</span><span class="code">,</span><span class="default">q</span><span class="code">,</span><span class="default">n</span><span class="code">,</span><span class="default">l</span><span class="code">;</span><span class="default">m</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="default">r</span><span class="code">.</span><span class="default">convertUrl</span><span class="brackets">(</span><span class="default">m</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">,</span><span class="default">k</span><span class="brackets">)</span><span class="code">;</span><span class="default">q</span><span class="code">=</span><span class="default">m</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">attrs</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">q</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">q</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="default">r</span><span class="code">.</span><span class="default">convertUrl</span><span class="brackets">(</span><span class="default">q</span><span class="code">.</span><span class="default">src</span><span class="code">,</span><span class="default">k</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">q</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">q</span><span class="code">.</span><span class="default">poster</span><span class="code">=</span><span class="default">r</span><span class="code">.</span><span class="default">convertUrl</span><span class="brackets">(</span><span class="default">q</span><span class="code">.</span><span class="default">poster</span><span class="code">,</span><span class="default">k</span><span class="brackets">)</span><span class="brackets">}</span><span class="default">j</span><span class="code">=</span><span class="default">c</span><span class="brackets">(</span><span class="default">m</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">sources</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">j</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">l</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">l</span><span class="code">&lt;</span><span class="default">j</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">l</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">j</span><span class="brackets">[</span><span class="default">l</span><span class="brackets">]</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="default">r</span><span class="code">.</span><span class="default">convertUrl</span><span class="brackets">(</span><span class="default">j</span><span class="brackets">[</span><span class="default">l</span><span class="brackets">]</span><span class="code">.</span><span class="default">src</span><span class="code">,</span><span class="default">k</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="default">n</span><span class="code">=</span><span class="default">r</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">dom</span><span class="code">.</span><span class="default">create</span><span class="brackets">(</span><span class="string">"</span><span class="string">img</span><span class="string">"</span><span class="code">,</span><span class="brackets">{</span><span class="default">id</span><span class="code">:</span><span class="default">m</span><span class="code">.</span><span class="default">id</span><span class="code">,</span><span class="default">style</span><span class="code">:</span><span class="default">m</span><span class="code">.</span><span class="default">style</span><span class="code">,</span><span class="default">align</span><span class="code">:</span><span class="default">m</span><span class="code">.</span><span class="default">align</span><span class="code">,</span><span class="default">src</span><span class="code">:</span><span class="default">r</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">theme</span><span class="code">.</span><span class="default">url</span><span class="code">+</span><span class="string">"</span><span class="string">/img/trans.gif</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">class</span><span class="string">"</span><span class="code">:</span><span class="string">"</span><span class="string">mceItemMedia mceItem</span><span class="string">"</span><span class="code">+</span><span class="default">r</span><span class="code">.</span><span class="default">getType</span><span class="brackets">(</span><span class="default">m</span><span class="code">.</span><span class="default">type</span><span class="brackets">)</span><span class="code">.</span><span class="default">name</span><span class="code">,</span><span class="string">"</span><span class="string">data-mce-json</span><span class="string">"</span><span class="code">:</span><span class="default">g</span><span class="code">.</span><span class="default">serialize</span><span class="brackets">(</span><span class="default">m</span><span class="code">,</span><span class="string">"</span><span class="string">'</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">width</span><span class="code">=</span><span class="default">m</span><span class="code">.</span><span class="default">width</span><span class="code">||</span><span class="string">"</span><span class="string">320</span><span class="string">"</span><span class="code">;</span><span class="default">n</span><span class="code">.</span><span class="default">height</span><span class="code">=</span><span class="default">m</span><span class="code">.</span><span class="default">height</span><span class="code">||</span><span class="string">"</span><span class="string">240</span><span class="string">"</span><span class="code">;</span><span class="keyword">return</span><span class="code"> </span><span class="default">n</span><span class="brackets">}</span><span class="code">,</span><span class="default">dataToHtml</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">j</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="code"> </span><span class="keyword">this</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">serializer</span><span class="code">.</span><span class="default">serialize</span><span class="brackets">(</span><span class="keyword">this</span><span class="code">.</span><span class="default">dataToImg</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">j</span><span class="brackets">)</span><span class="code">,</span><span class="brackets">{</span><span class="default">force_absolute</span><span class="code">:</span><span class="default">j</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="code">,</span><span class="default">htmlToData</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">k</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">j</span><span class="code">,</span><span class="default">i</span><span class="code">,</span><span class="default">l</span><span class="code">;</span><span class="default">l</span><span class="code">=</span><span class="brackets">{</span><span class="default">type</span><span class="code">:</span><span class="string">"</span><span class="string">flash</span><span class="string">"</span><span class="code">,</span><span class="default">video</span><span class="code">:</span><span class="brackets">{</span><span class="default">sources</span><span class="code">:</span><span class="brackets">[</span><span class="brackets">]</span><span class="brackets">}</span><span class="code">,</span><span class="default">params</span><span class="code">:</span><span class="brackets">{</span><span class="brackets">}</span><span class="brackets">}</span><span class="code">;</span><span class="default">j</span><span class="code">=</span><span class="keyword">this</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">parser</span><span class="code">.</span><span class="default">parse</span><span class="brackets">(</span><span class="default">k</span><span class="brackets">)</span><span class="code">;</span><span class="default">i</span><span class="code">=</span><span class="default">j</span><span class="code">.</span><span class="default">getAll</span><span class="brackets">(</span><span class="string">"</span><span class="string">img</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">l</span><span class="code">=</span><span class="default">g</span><span class="code">.</span><span class="default">parse</span><span class="brackets">(</span><span class="default">i</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">data-mce-json</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="default">l</span><span class="code">.</span><span class="default">type</span><span class="code">=</span><span class="keyword">this</span><span class="code">.</span><span class="default">getType</span><span class="brackets">(</span><span class="default">i</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">class</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">.</span><span class="default">name</span><span class="code">.</span><span class="default">toLowerCase</span><span class="brackets">(</span><span class="brackets">)</span><span class="code">;</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">d</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">m</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">n</span><span class="code">=</span><span class="default">i</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">m</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">n</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">l</span><span class="brackets">[</span><span class="default">m</span><span class="brackets">]</span><span class="code">=</span><span class="default">n</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">return</span><span class="code"> </span><span class="default">l</span><span class="brackets">}</span><span class="code">,</span><span class="default">getType</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">m</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">k</span><span class="code">,</span><span class="default">j</span><span class="code">,</span><span class="default">l</span><span class="code">;</span><span class="default">j</span><span class="code">=</span><span class="default">tinymce</span><span class="code">.</span><span class="default">explode</span><span class="brackets">(</span><span class="default">m</span><span class="code">,</span><span class="string">"</span><span class="string"> </span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">k</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">k</span><span class="code">&lt;</span><span class="default">j</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">k</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">l</span><span class="code">=</span><span class="keyword">this</span><span class="code">.</span><span class="default">lookup</span><span class="brackets">[</span><span class="default">j</span><span class="brackets">[</span><span class="default">k</span><span class="brackets">]</span><span class="brackets">]</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">l</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="code"> </span><span class="default">l</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">}</span><span class="code">,</span><span class="default">imgToObject</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">x</span><span class="code">,</span><span class="default">n</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">t</span><span class="code">=</span><span class="keyword">this</span><span class="code">,</span><span class="default">o</span><span class="code">=</span><span class="default">t</span><span class="code">.</span><span class="default">editor</span><span class="code">,</span><span class="default">A</span><span class="code">,</span><span class="default">E</span><span class="code">,</span><span class="default">j</span><span class="code">,</span><span class="default">s</span><span class="code">,</span><span class="default">F</span><span class="code">,</span><span class="default">w</span><span class="code">,</span><span class="default">D</span><span class="code">,</span><span class="default">u</span><span class="code">,</span><span class="default">k</span><span class="code">,</span><span class="default">C</span><span class="code">,</span><span class="default">r</span><span class="code">,</span><span class="default">p</span><span class="code">,</span><span class="default">y</span><span class="code">,</span><span class="default">B</span><span class="code">,</span><span class="default">m</span><span class="code">,</span><span class="default">v</span><span class="code">,</span><span class="default">l</span><span class="code">,</span><span class="default">z</span><span class="code">;</span><span class="keyword">function</span><span class="code"> </span><span class="default">q</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">G</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">K</span><span class="code">,</span><span class="default">J</span><span class="code">,</span><span class="default">L</span><span class="code">,</span><span class="default">I</span><span class="code">,</span><span class="default">H</span><span class="code">;</span><span class="default">H</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">getParam</span><span class="brackets">(</span><span class="string">"</span><span class="string">flash_video_player_url</span><span class="string">"</span><span class="code">,</span><span class="default">t</span><span class="code">.</span><span class="default">convertUrl</span><span class="brackets">(</span><span class="default">t</span><span class="code">.</span><span class="default">url</span><span class="code">+</span><span class="string">"</span><span class="string">/moxieplayer.swf</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">H</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">K</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">documentBaseURI</span><span class="code">;</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="default">H</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">o</span><span class="code">.</span><span class="default">getParam</span><span class="brackets">(</span><span class="string">"</span><span class="string">flash_video_player_absvideourl</span><span class="string">"</span><span class="code">,</span><span class="keyword">true</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">i</span><span class="code">=</span><span class="default">K</span><span class="code">.</span><span class="default">toAbsolute</span><span class="brackets">(</span><span class="default">i</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="code">,</span><span class="keyword">true</span><span class="brackets">)</span><span class="code">;</span><span class="default">G</span><span class="code">=</span><span class="default">K</span><span class="code">.</span><span class="default">toAbsolute</span><span class="brackets">(</span><span class="default">G</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="code">,</span><span class="keyword">true</span><span class="brackets">)</span><span class="brackets">}</span><span class="default">L</span><span class="code">=</span><span class="string">"</span><span class="string">"</span><span class="code">;</span><span class="default">J</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">getParam</span><span class="brackets">(</span><span class="string">"</span><span class="string">flash_video_player_flashvars</span><span class="string">"</span><span class="code">,</span><span class="brackets">{</span><span class="default">url</span><span class="code">:</span><span class="string">"</span><span class="string">$url</span><span class="string">"</span><span class="code">,</span><span class="default">poster</span><span class="code">:</span><span class="string">"</span><span class="string">$poster</span><span class="string">"</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">J</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">N</span><span class="code">,</span><span class="default">M</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">N</span><span class="code">=</span><span class="default">N</span><span class="code">.</span><span class="default">replace</span><span class="brackets">(</span><span class="code">/\$</span><span class="default">url</span><span class="code">/,</span><span class="default">i</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">N</span><span class="code">=</span><span class="default">N</span><span class="code">.</span><span class="default">replace</span><span class="brackets">(</span><span class="code">/\$</span><span class="default">poster</span><span class="code">/,</span><span class="default">G</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">N</span><span class="code">.</span><span class="default">length</span><span class="code">&gt;</span><span class="number">0</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">L</span><span class="code">+=</span><span class="brackets">(</span><span class="default">L</span><span class="code">?</span><span class="string">"</span><span class="string">&amp;</span><span class="string">"</span><span class="code">:</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">+</span><span class="default">M</span><span class="code">+</span><span class="string">"</span><span class="string">=</span><span class="string">"</span><span class="code">+</span><span class="default">escape</span><span class="brackets">(</span><span class="default">N</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">L</span><span class="code">.</span><span class="default">length</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">flashvars</span><span class="code">=</span><span class="default">L</span><span class="brackets">}</span><span class="default">I</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">getParam</span><span class="brackets">(</span><span class="string">"</span><span class="string">flash_video_player_params</span><span class="string">"</span><span class="code">,</span><span class="brackets">{</span><span class="default">allowfullscreen</span><span class="code">:</span><span class="keyword">true</span><span class="code">,</span><span class="default">allowscriptaccess</span><span class="code">:</span><span class="keyword">true</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">I</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">N</span><span class="code">,</span><span class="default">M</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">M</span><span class="brackets">]</span><span class="code">=</span><span class="string">"</span><span class="string">"</span><span class="code">+</span><span class="default">N</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="default">D</span><span class="code">=</span><span class="default">g</span><span class="code">.</span><span class="default">parse</span><span class="brackets">(</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">data-mce-json</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="default">p</span><span class="code">=</span><span class="keyword">this</span><span class="code">.</span><span class="default">getType</span><span class="brackets">(</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">class</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="default">z</span><span class="code">=</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">data-mce-style</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">z</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">z</span><span class="code">=</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">style</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">z</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">z</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">dom</span><span class="code">.</span><span class="default">serializeStyle</span><span class="brackets">(</span><span class="default">o</span><span class="code">.</span><span class="default">dom</span><span class="code">.</span><span class="default">parseStyle</span><span class="brackets">(</span><span class="default">z</span><span class="code">,</span><span class="string">"</span><span class="string">img</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">p</span><span class="code">.</span><span class="default">name</span><span class="code">===</span><span class="string">"</span><span class="string">Iframe</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">v</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">iframe</span><span class="string">"</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="code">;</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">d</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">G</span><span class="code">=</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">i</span><span class="code">==</span><span class="string">"</span><span class="string">class</span><span class="string">"</span><span class="code">&amp;&amp;</span><span class="default">G</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">G</span><span class="code">=</span><span class="default">G</span><span class="code">.</span><span class="default">replace</span><span class="brackets">(</span><span class="code">/</span><span class="default">mceItem</span><span class="code">.+ ?/</span><span class="default">g</span><span class="code">,</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">G</span><span class="code">&amp;&amp;</span><span class="default">G</span><span class="code">.</span><span class="default">length</span><span class="code">&gt;</span><span class="number">0</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">v</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">G</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">F</span><span class="code"> </span><span class="keyword">in</span><span class="code"> </span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">v</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">F</span><span class="code">,</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">F</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">}</span><span class="default">v</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">style</span><span class="code">:</span><span class="default">z</span><span class="code">,</span><span class="default">src</span><span class="code">:</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">x</span><span class="code">.</span><span class="default">replace</span><span class="brackets">(</span><span class="default">v</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">return</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="keyword">this</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">settings</span><span class="code">.</span><span class="default">media_use_script</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">v</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">script</span><span class="string">"</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">type</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">text/javascript</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">w</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">#text</span><span class="string">"</span><span class="code">,</span><span class="number">3</span><span class="brackets">)</span><span class="code">;</span><span class="default">w</span><span class="code">.</span><span class="default">value</span><span class="code">=</span><span class="string">"</span><span class="string">write</span><span class="string">"</span><span class="code">+</span><span class="default">p</span><span class="code">.</span><span class="default">name</span><span class="code">+</span><span class="string">"</span><span class="string">(</span><span class="string">"</span><span class="code">+</span><span class="default">g</span><span class="code">.</span><span class="default">serialize</span><span class="brackets">(</span><span class="default">tinymce</span><span class="code">.</span><span class="default">extend</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">,</span><span class="brackets">{</span><span class="default">width</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">width</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">height</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">height</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">+</span><span class="string">"</span><span class="string">);</span><span class="string">"</span><span class="code">;</span><span class="default">v</span><span class="code">.</span><span class="default">append</span><span class="brackets">(</span><span class="default">w</span><span class="brackets">)</span><span class="code">;</span><span class="default">x</span><span class="code">.</span><span class="default">replace</span><span class="brackets">(</span><span class="default">v</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">return</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">p</span><span class="code">.</span><span class="default">name</span><span class="code">===</span><span class="string">"</span><span class="string">Video</span><span class="string">"</span><span class="code">&amp;&amp;</span><span class="default">D</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">sources</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">A</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">video</span><span class="string">"</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">tinymce</span><span class="code">.</span><span class="default">extend</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">id</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">id</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">width</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">width</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">height</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">height</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">style</span><span class="code">:</span><span class="default">z</span><span class="brackets">}</span><span class="code">,</span><span class="default">D</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">attrs</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">attrs</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">l</span><span class="code">=</span><span class="default">D</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">attrs</span><span class="code">.</span><span class="default">poster</span><span class="brackets">}</span><span class="default">k</span><span class="code">=</span><span class="default">D</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">sources</span><span class="code">=</span><span class="default">c</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">sources</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">y</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">y</span><span class="code">&lt;</span><span class="default">k</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">y</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">/\.</span><span class="default">mp4</span><span class="code">$/.</span><span class="default">test</span><span class="brackets">(</span><span class="default">k</span><span class="brackets">[</span><span class="default">y</span><span class="brackets">]</span><span class="code">.</span><span class="default">src</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">m</span><span class="code">=</span><span class="default">k</span><span class="brackets">[</span><span class="default">y</span><span class="brackets">]</span><span class="code">.</span><span class="default">src</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">k</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="code">.</span><span class="default">type</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">A</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">src</span><span class="string">"</span><span class="code">,</span><span class="default">k</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="code">.</span><span class="default">src</span><span class="brackets">)</span><span class="code">;</span><span class="default">k</span><span class="code">.</span><span class="default">splice</span><span class="brackets">(</span><span class="number">0</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">y</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">y</span><span class="code">&lt;</span><span class="default">k</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">y</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">u</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">source</span><span class="string">"</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">k</span><span class="brackets">[</span><span class="default">y</span><span class="brackets">]</span><span class="brackets">)</span><span class="code">;</span><span class="default">u</span><span class="code">.</span><span class="default">shortEnded</span><span class="code">=</span><span class="keyword">true</span><span class="code">;</span><span class="default">A</span><span class="code">.</span><span class="default">append</span><span class="brackets">(</span><span class="default">u</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">m</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">q</span><span class="brackets">(</span><span class="default">m</span><span class="code">,</span><span class="default">l</span><span class="brackets">)</span><span class="code">;</span><span class="default">p</span><span class="code">=</span><span class="default">t</span><span class="code">.</span><span class="default">getType</span><span class="brackets">(</span><span class="string">"</span><span class="string">flash</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">else</span><span class="brackets">{</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="string">"</span><span class="string">"</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">/\.</span><span class="default">flv</span><span class="code">$/</span><span class="default">i</span><span class="code">.</span><span class="default">test</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">q</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">,</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">n</span><span class="code">&amp;&amp;</span><span class="default">n</span><span class="code">.</span><span class="default">force_absolute</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">documentBaseURI</span><span class="code">.</span><span class="default">toAbsolute</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="brackets">)</span><span class="brackets">}</span><span class="default">E</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">object</span><span class="string">"</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">id</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">id</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">width</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">width</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">height</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">height</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">style</span><span class="code">:</span><span class="default">z</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">d</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">D</span><span class="brackets">[</span><span class="default">i</span><span class="brackets">]</span><span class="code">&amp;&amp;</span><span class="default">i</span><span class="code">!=</span><span class="string">"</span><span class="string">type</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">D</span><span class="brackets">[</span><span class="default">i</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">F</span><span class="code"> </span><span class="keyword">in</span><span class="code"> </span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">r</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">param</span><span class="string">"</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="code">;</span><span class="default">r</span><span class="code">.</span><span class="default">shortEnded</span><span class="code">=</span><span class="keyword">true</span><span class="code">;</span><span class="default">w</span><span class="code">=</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">F</span><span class="brackets">]</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">F</span><span class="code">===</span><span class="string">"</span><span class="string">src</span><span class="string">"</span><span class="code">&amp;&amp;</span><span class="default">p</span><span class="code">.</span><span class="default">name</span><span class="code">===</span><span class="string">"</span><span class="string">WindowsMedia</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">F</span><span class="code">=</span><span class="string">"</span><span class="string">url</span><span class="string">"</span><span class="brackets">}</span><span class="default">r</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">name</span><span class="code">:</span><span class="default">F</span><span class="code">,</span><span class="default">value</span><span class="code">:</span><span class="default">w</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">E</span><span class="code">.</span><span class="default">append</span><span class="brackets">(</span><span class="default">r</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="keyword">this</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">getParam</span><span class="brackets">(</span><span class="string">"</span><span class="string">media_strict</span><span class="string">"</span><span class="code">,</span><span class="keyword">true</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">data</span><span class="code">:</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">,</span><span class="default">type</span><span class="code">:</span><span class="default">p</span><span class="code">.</span><span class="default">mimes</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">else</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">classid</span><span class="code">:</span><span class="string">"</span><span class="string">clsid:</span><span class="string">"</span><span class="code">+</span><span class="default">p</span><span class="code">.</span><span class="default">clsids</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="code">,</span><span class="default">codebase</span><span class="code">:</span><span class="default">p</span><span class="code">.</span><span class="default">codebase</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">j</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">embed</span><span class="string">"</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="code">;</span><span class="default">j</span><span class="code">.</span><span class="default">shortEnded</span><span class="code">=</span><span class="keyword">true</span><span class="code">;</span><span class="default">j</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">id</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">id</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">width</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">width</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">height</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">height</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">style</span><span class="code">:</span><span class="default">z</span><span class="code">,</span><span class="default">type</span><span class="code">:</span><span class="default">p</span><span class="code">.</span><span class="default">mimes</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">F</span><span class="code"> </span><span class="keyword">in</span><span class="code"> </span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">j</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">F</span><span class="code">,</span><span class="default">D</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">F</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">}</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">d</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">D</span><span class="brackets">[</span><span class="default">i</span><span class="brackets">]</span><span class="code">&amp;&amp;</span><span class="default">i</span><span class="code">!=</span><span class="string">"</span><span class="string">type</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">j</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">D</span><span class="brackets">[</span><span class="default">i</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">E</span><span class="code">.</span><span class="default">append</span><span class="brackets">(</span><span class="default">j</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">object_html</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">w</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">#text</span><span class="string">"</span><span class="code">,</span><span class="number">3</span><span class="brackets">)</span><span class="code">;</span><span class="default">w</span><span class="code">.</span><span class="default">raw</span><span class="code">=</span><span class="keyword">true</span><span class="code">;</span><span class="default">w</span><span class="code">.</span><span class="default">value</span><span class="code">=</span><span class="default">D</span><span class="code">.</span><span class="default">object_html</span><span class="code">;</span><span class="default">E</span><span class="code">.</span><span class="default">append</span><span class="brackets">(</span><span class="default">w</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">A</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">A</span><span class="code">.</span><span class="default">append</span><span class="brackets">(</span><span class="default">E</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">A</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">D</span><span class="code">.</span><span class="default">video_html</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">w</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">#text</span><span class="string">"</span><span class="code">,</span><span class="number">3</span><span class="brackets">)</span><span class="code">;</span><span class="default">w</span><span class="code">.</span><span class="default">raw</span><span class="code">=</span><span class="keyword">true</span><span class="code">;</span><span class="default">w</span><span class="code">.</span><span class="default">value</span><span class="code">=</span><span class="default">D</span><span class="code">.</span><span class="default">video_html</span><span class="code">;</span><span class="default">A</span><span class="code">.</span><span class="default">append</span><span class="brackets">(</span><span class="default">w</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">A</span><span class="code">||</span><span class="default">E</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">x</span><span class="code">.</span><span class="default">replace</span><span class="brackets">(</span><span class="default">A</span><span class="code">||</span><span class="default">E</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">else</span><span class="brackets">{</span><span class="default">x</span><span class="code">.</span><span class="default">remove</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="code">,</span><span class="default">objectToImg</span><span class="code">:</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">y</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">var</span><span class="code"> </span><span class="default">F</span><span class="code">,</span><span class="default">j</span><span class="code">,</span><span class="default">A</span><span class="code">,</span><span class="default">p</span><span class="code">,</span><span class="default">G</span><span class="code">,</span><span class="default">H</span><span class="code">,</span><span class="default">u</span><span class="code">,</span><span class="default">w</span><span class="code">,</span><span class="default">t</span><span class="code">,</span><span class="default">B</span><span class="code">,</span><span class="default">z</span><span class="code">,</span><span class="default">q</span><span class="code">,</span><span class="default">o</span><span class="code">,</span><span class="default">D</span><span class="code">,</span><span class="default">x</span><span class="code">,</span><span class="default">k</span><span class="code">,</span><span class="default">E</span><span class="code">,</span><span class="default">n</span><span class="code">,</span><span class="default">C</span><span class="code">=</span><span class="keyword">this</span><span class="code">.</span><span class="default">lookup</span><span class="code">,</span><span class="default">l</span><span class="code">,</span><span class="default">v</span><span class="code">,</span><span class="default">s</span><span class="code">=</span><span class="keyword">this</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">settings</span><span class="code">.</span><span class="default">url_converter</span><span class="code">,</span><span class="default">m</span><span class="code">=</span><span class="keyword">this</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">settings</span><span class="code">.</span><span class="default">url_converter_scope</span><span class="code">;</span><span class="keyword">function</span><span class="code"> </span><span class="default">r</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="code"> </span><span class="keyword">new</span><span class="code"> </span><span class="default">tinymce</span><span class="code">.</span><span class="default">html</span><span class="code">.</span><span class="default">Serializer</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">inner</span><span class="code">:</span><span class="keyword">true</span><span class="code">,</span><span class="default">validate</span><span class="code">:</span><span class="keyword">false</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">.</span><span class="default">serialize</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">y</span><span class="code">.</span><span class="default">parent</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">y</span><span class="code">.</span><span class="default">name</span><span class="code">===</span><span class="string">"</span><span class="string">script</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">y</span><span class="code">.</span><span class="default">firstChild</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">l</span><span class="code">=</span><span class="default">a</span><span class="code">.</span><span class="default">exec</span><span class="brackets">(</span><span class="default">y</span><span class="code">.</span><span class="default">firstChild</span><span class="code">.</span><span class="default">value</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">l</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">return</span><span class="brackets">}</span><span class="default">n</span><span class="code">=</span><span class="default">l</span><span class="brackets">[</span><span class="number">1</span><span class="brackets">]</span><span class="code">;</span><span class="default">E</span><span class="code">=</span><span class="brackets">{</span><span class="default">video</span><span class="code">:</span><span class="brackets">{</span><span class="brackets">}</span><span class="code">,</span><span class="default">params</span><span class="code">:</span><span class="default">g</span><span class="code">.</span><span class="default">parse</span><span class="brackets">(</span><span class="default">l</span><span class="brackets">[</span><span class="number">2</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">}</span><span class="code">;</span><span class="default">w</span><span class="code">=</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">width</span><span class="code">;</span><span class="default">t</span><span class="code">=</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">height</span><span class="brackets">}</span><span class="default">E</span><span class="code">=</span><span class="default">E</span><span class="code">||</span><span class="brackets">{</span><span class="default">video</span><span class="code">:</span><span class="brackets">{</span><span class="brackets">}</span><span class="code">,</span><span class="default">params</span><span class="code">:</span><span class="brackets">{</span><span class="brackets">}</span><span class="brackets">}</span><span class="code">;</span><span class="default">G</span><span class="code">=</span><span class="keyword">new</span><span class="code"> </span><span class="default">b</span><span class="brackets">(</span><span class="string">"</span><span class="string">img</span><span class="string">"</span><span class="code">,</span><span class="number">1</span><span class="brackets">)</span><span class="code">;</span><span class="default">G</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">src</span><span class="code">:</span><span class="keyword">this</span><span class="code">.</span><span class="default">editor</span><span class="code">.</span><span class="default">theme</span><span class="code">.</span><span class="default">url</span><span class="code">+</span><span class="string">"</span><span class="string">/img/trans.gif</span><span class="string">"</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">H</span><span class="code">=</span><span class="default">y</span><span class="code">.</span><span class="default">name</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">H</span><span class="code">===</span><span class="string">"</span><span class="string">video</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">A</span><span class="code">=</span><span class="default">y</span><span class="code">;</span><span class="default">F</span><span class="code">=</span><span class="default">y</span><span class="code">.</span><span class="default">getAll</span><span class="brackets">(</span><span class="string">"</span><span class="string">object</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="code">;</span><span class="default">j</span><span class="code">=</span><span class="default">y</span><span class="code">.</span><span class="default">getAll</span><span class="brackets">(</span><span class="string">"</span><span class="string">embed</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="code">;</span><span class="default">w</span><span class="code">=</span><span class="default">A</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">width</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">t</span><span class="code">=</span><span class="default">A</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">height</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">u</span><span class="code">=</span><span class="default">A</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">id</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">E</span><span class="code">.</span><span class="default">video</span><span class="code">=</span><span class="brackets">{</span><span class="default">attrs</span><span class="code">:</span><span class="brackets">{</span><span class="brackets">}</span><span class="code">,</span><span class="default">sources</span><span class="code">:</span><span class="brackets">[</span><span class="brackets">]</span><span class="brackets">}</span><span class="code">;</span><span class="default">v</span><span class="code">=</span><span class="default">E</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">attrs</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">H</span><span class="code"> </span><span class="keyword">in</span><span class="code"> </span><span class="default">A</span><span class="code">.</span><span class="default">attributes</span><span class="code">.</span><span class="default">map</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">v</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="code">=</span><span class="default">A</span><span class="code">.</span><span class="default">attributes</span><span class="code">.</span><span class="default">map</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="brackets">}</span><span class="default">x</span><span class="code">=</span><span class="default">y</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">src</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">x</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">sources</span><span class="code">.</span><span class="default">push</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">src</span><span class="code">:</span><span class="default">s</span><span class="code">.</span><span class="default">call</span><span class="brackets">(</span><span class="default">m</span><span class="code">,</span><span class="default">x</span><span class="code">,</span><span class="string">"</span><span class="string">src</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">video</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="default">k</span><span class="code">=</span><span class="default">A</span><span class="code">.</span><span class="default">getAll</span><span class="brackets">(</span><span class="string">"</span><span class="string">source</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">z</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">z</span><span class="code">&lt;</span><span class="default">k</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">z</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">x</span><span class="code">=</span><span class="default">k</span><span class="brackets">[</span><span class="default">z</span><span class="brackets">]</span><span class="code">.</span><span class="default">remove</span><span class="brackets">(</span><span class="brackets">)</span><span class="code">;</span><span class="default">E</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">sources</span><span class="code">.</span><span class="default">push</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">src</span><span class="code">:</span><span class="default">s</span><span class="code">.</span><span class="default">call</span><span class="brackets">(</span><span class="default">m</span><span class="code">,</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">src</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="string">"</span><span class="string">src</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">source</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">type</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">type</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">media</span><span class="code">:</span><span class="default">x</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">media</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">v</span><span class="code">.</span><span class="default">poster</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">v</span><span class="code">.</span><span class="default">poster</span><span class="code">=</span><span class="default">s</span><span class="code">.</span><span class="default">call</span><span class="brackets">(</span><span class="default">m</span><span class="code">,</span><span class="default">v</span><span class="code">.</span><span class="default">poster</span><span class="code">,</span><span class="string">"</span><span class="string">poster</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">video</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">y</span><span class="code">.</span><span class="default">name</span><span class="code">===</span><span class="string">"</span><span class="string">object</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">F</span><span class="code">=</span><span class="default">y</span><span class="code">;</span><span class="default">j</span><span class="code">=</span><span class="default">y</span><span class="code">.</span><span class="default">getAll</span><span class="brackets">(</span><span class="string">"</span><span class="string">embed</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">[</span><span class="number">0</span><span class="brackets">]</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">y</span><span class="code">.</span><span class="default">name</span><span class="code">===</span><span class="string">"</span><span class="string">embed</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">j</span><span class="code">=</span><span class="default">y</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">y</span><span class="code">.</span><span class="default">name</span><span class="code">===</span><span class="string">"</span><span class="string">iframe</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">p</span><span class="code">=</span><span class="default">y</span><span class="code">;</span><span class="default">n</span><span class="code">=</span><span class="string">"</span><span class="string">Iframe</span><span class="string">"</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">F</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">w</span><span class="code">=</span><span class="default">w</span><span class="code">||</span><span class="default">F</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">width</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">t</span><span class="code">=</span><span class="default">t</span><span class="code">||</span><span class="default">F</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">height</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">B</span><span class="code">=</span><span class="default">B</span><span class="code">||</span><span class="default">F</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">style</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">u</span><span class="code">=</span><span class="default">u</span><span class="code">||</span><span class="default">F</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">id</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">D</span><span class="code">=</span><span class="default">F</span><span class="code">.</span><span class="default">getAll</span><span class="brackets">(</span><span class="string">"</span><span class="string">param</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">z</span><span class="code">=</span><span class="number">0</span><span class="code">;</span><span class="default">z</span><span class="code">&lt;</span><span class="default">D</span><span class="code">.</span><span class="default">length</span><span class="code">;</span><span class="default">z</span><span class="code">++</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">o</span><span class="code">=</span><span class="default">D</span><span class="brackets">[</span><span class="default">z</span><span class="brackets">]</span><span class="code">;</span><span class="default">H</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">remove</span><span class="brackets">(</span><span class="brackets">)</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">name</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">h</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="code">=</span><span class="default">o</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">value</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">||</span><span class="default">F</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">data</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">j</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">w</span><span class="code">=</span><span class="default">w</span><span class="code">||</span><span class="default">j</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">width</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">t</span><span class="code">=</span><span class="default">t</span><span class="code">||</span><span class="default">j</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">height</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">B</span><span class="code">=</span><span class="default">B</span><span class="code">||</span><span class="default">j</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">style</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">u</span><span class="code">=</span><span class="default">u</span><span class="code">||</span><span class="default">j</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">id</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">H</span><span class="code"> </span><span class="keyword">in</span><span class="code"> </span><span class="default">j</span><span class="code">.</span><span class="default">attributes</span><span class="code">.</span><span class="default">map</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">h</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="code">&amp;&amp;!</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="code">=</span><span class="default">j</span><span class="code">.</span><span class="default">attributes</span><span class="code">.</span><span class="default">map</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">p</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">w</span><span class="code">=</span><span class="default">p</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">width</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">t</span><span class="code">=</span><span class="default">p</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">height</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">B</span><span class="code">=</span><span class="default">B</span><span class="code">||</span><span class="default">p</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">style</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">u</span><span class="code">=</span><span class="default">p</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">id</span><span class="string">"</span><span class="brackets">)</span><span class="code">;</span><span class="default">tinymce</span><span class="code">.</span><span class="default">each</span><span class="brackets">(</span><span class="default">d</span><span class="code">,</span><span class="keyword">function</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">G</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">i</span><span class="code">,</span><span class="default">p</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="default">i</span><span class="brackets">)</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">for</span><span class="brackets">(</span><span class="default">H</span><span class="code"> </span><span class="keyword">in</span><span class="code"> </span><span class="default">p</span><span class="code">.</span><span class="default">attributes</span><span class="code">.</span><span class="default">map</span><span class="brackets">)</span><span class="brackets">{</span><span class="keyword">if</span><span class="brackets">(</span><span class="code">!</span><span class="default">h</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="code">&amp;&amp;!</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="code">=</span><span class="default">p</span><span class="code">.</span><span class="default">attributes</span><span class="code">.</span><span class="default">map</span><span class="brackets">[</span><span class="default">H</span><span class="brackets">]</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">movie</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">||</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">movie</span><span class="code">;</span><span class="keyword">delete</span><span class="code"> </span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">movie</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">=</span><span class="default">s</span><span class="code">.</span><span class="default">call</span><span class="brackets">(</span><span class="default">m</span><span class="code">,</span><span class="default">E</span><span class="code">.</span><span class="default">params</span><span class="code">.</span><span class="default">src</span><span class="code">,</span><span class="string">"</span><span class="string">src</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">object</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">A</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">n</span><span class="code">=</span><span class="default">C</span><span class="code">.</span><span class="default">video</span><span class="code">.</span><span class="default">name</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">F</span><span class="code">&amp;&amp;!</span><span class="default">n</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">n</span><span class="code">=</span><span class="brackets">(</span><span class="default">C</span><span class="brackets">[</span><span class="brackets">(</span><span class="default">F</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">clsid</span><span class="string">"</span><span class="brackets">)</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">.</span><span class="default">toLowerCase</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">]</span><span class="code">||</span><span class="default">C</span><span class="brackets">[</span><span class="brackets">(</span><span class="default">F</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">type</span><span class="string">"</span><span class="brackets">)</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">.</span><span class="default">toLowerCase</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">]</span><span class="code">||</span><span class="brackets">{</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">.</span><span class="default">name</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">j</span><span class="code">&amp;&amp;!</span><span class="default">n</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">n</span><span class="code">=</span><span class="brackets">(</span><span class="default">C</span><span class="brackets">[</span><span class="brackets">(</span><span class="default">j</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="string">"</span><span class="string">type</span><span class="string">"</span><span class="brackets">)</span><span class="code">||</span><span class="string">"</span><span class="string">"</span><span class="brackets">)</span><span class="code">.</span><span class="default">toLowerCase</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">]</span><span class="code">||</span><span class="brackets">{</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">.</span><span class="default">name</span><span class="brackets">}</span><span class="default">y</span><span class="code">.</span><span class="default">replace</span><span class="brackets">(</span><span class="default">G</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">j</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">j</span><span class="code">.</span><span class="default">remove</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">F</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">q</span><span class="code">=</span><span class="default">r</span><span class="brackets">(</span><span class="default">F</span><span class="code">.</span><span class="default">remove</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">q</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">object_html</span><span class="code">=</span><span class="default">q</span><span class="brackets">}</span><span class="brackets">}</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">A</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">q</span><span class="code">=</span><span class="default">r</span><span class="brackets">(</span><span class="default">A</span><span class="code">.</span><span class="default">remove</span><span class="brackets">(</span><span class="brackets">)</span><span class="brackets">)</span><span class="code">;</span><span class="keyword">if</span><span class="brackets">(</span><span class="default">q</span><span class="brackets">)</span><span class="brackets">{</span><span class="default">E</span><span class="code">.</span><span class="default">video_html</span><span class="code">=</span><span class="default">q</span><span class="brackets">}</span><span class="brackets">}</span><span class="default">G</span><span class="code">.</span><span class="default">attr</span><span class="brackets">(</span><span class="brackets">{</span><span class="default">id</span><span class="code">:</span><span class="default">u</span><span class="code">,</span><span class="string">"</span><span class="string">class</span><span class="string">"</span><span class="code">:</span><span class="string">"</span><span class="string">mceItemMedia mceItem</span><span class="string">"</span><span class="code">+</span><span class="brackets">(</span><span class="default">n</span><span class="code">||</span><span class="string">"</span><span class="string">Flash</span><span class="string">"</span><span class="brackets">)</span><span class="code">,</span><span class="default">style</span><span class="code">:</span><span class="default">B</span><span class="code">,</span><span class="default">width</span><span class="code">:</span><span class="default">w</span><span class="code">||</span><span class="string">"</span><span class="string">320</span><span class="string">"</span><span class="code">,</span><span class="default">height</span><span class="code">:</span><span class="default">t</span><span class="code">||</span><span class="string">"</span><span class="string">240</span><span class="string">"</span><span class="code">,</span><span class="string">"</span><span class="string">data-mce-json</span><span class="string">"</span><span class="code">:</span><span class="default">g</span><span class="code">.</span><span class="default">serialize</span><span class="brackets">(</span><span class="default">E</span><span class="code">,</span><span class="string">"</span><span class="string">'</span><span class="string">"</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">}</span><span class="brackets">)</span><span class="code">;</span><span class="default">tinymce</span><span class="code">.</span><span class="default">PluginManager</span><span class="code">.</span><span class="default">add</span><span class="brackets">(</span><span class="string">"</span><span class="string">media</span><span class="string">"</span><span class="code">,</span><span class="default">tinymce</span><span class="code">.</span><span class="default">plugins</span><span class="code">.</span><span class="default">MediaPlugin</span><span class="brackets">)</span><span class="brackets">}</span><span class="brackets">)</span><span class="brackets">(</span><span class="brackets">)</span><span class="code">;</span><a name="line_1"></a></li></ol></div></body></html>
                    </div>
    </body>
</html>
